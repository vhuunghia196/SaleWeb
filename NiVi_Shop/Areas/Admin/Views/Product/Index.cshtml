@model IEnumerable<NiVi_Shop.Models.Product>
@{
    ViewBag.Title = "Sản phẩm";
    Layout = "~/Areas/Admin/Views/Shared/_Layout.cshtml";
}

@section naviheader {

    <ul class="navbar-nav">
        <li class="nav-item">
            <a class="nav-link" data-widget="pushmenu" href="#" role="button"><i class="fas fa-bars"></i></a>
        </li>
        <li class="nav-item d-none d-sm-inline-block">
            <a href="/admin/home" class="nav-link">Home</a>
        </li>
        <li class="nav-item d-none d-sm-inline-block">
            <a href="#" class="nav-link">Product</a>
        </li>
    </ul>
}


<div class="card">
    <div class="card-header p-2">
        <div class="card-header">
            <h3 class="card-title">Product List</h3>

            <div class="card-tools">
                <a href="/admin/product/add" class="btn btn-primary">Add</a>
            </div>
        </div>
        <ul class="nav nav-pills">
            <li class="nav-item"><a class="nav-link active" href="#Decor" data-toggle="tab">Decor</a></li>
            <li class="nav-item"><a class="nav-link" href="#Chair" data-toggle="tab">Chair</a></li>
            <li class="nav-item"><a class="nav-link" href="#Light" data-toggle="tab">Light</a></li>
            <li class="nav-item"><a class="nav-link" href="#Plant" data-toggle="tab">Plant</a></li>
        </ul>
    </div><!-- /.card-header -->
    <div class="card-body">
        <div class="tab-content">
            <div class="tab-pane active" id="Decor">
                <!-- Main content -->
                <section class="content">

                    <!-- Default box -->
                    <div class="card">
                        <div class="card-body">
                            <table class="table table-hover">
                                <thead>
                                    <tr>
                                        <th>Id</th>
                                        <th>Name</th>
                                        <th width="20%">Image</th>
                                        <th>Price</th>
                                        <th>Quantity</th>
                                        <th width="80%">Detail</th>
                                        <th>Supplier</th>
                                        <th>Category</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    @if (Model != null && Model.Any())
                                    {
                                        foreach (var item in Model)
                                        {
                                            if (@item.Categories.CategoryName == "Decor")
                                            {
                                                <tr id="@item.ProductID">
                                                    <td>@item.ProductID</td>
                                                    <td>@item.Name</td>
                                                    <td><img src="@item.Image" width="100px" alt="IMAGE" /></td>
                                                    <td>@item.Price</td>
                                                    <td>@item.Quantity</td>
                                                    <td>@item.Detail</td>
                                                    <td>@item.Supplier.Name</td>
                                                    <td>@item.Categories.CategoryName</td>
                                                    <td><button class="btn btn-danger remove-product">Remove</button></td>
                                                    <td><a href="/admin/product/edit/@item.ProductID" class="btn btn-primary update-product">Update</a></td>
                                                </tr>
                                            }

                                        }

                                    }
                                    else
                                    {
                                        <tr>
                                            <td colspan="8">No product</td>
                                        </tr>
                                    }
                                </tbody>
                            </table>

                        </div>
                        <!-- /.card-body -->
                        <div class="card-footer">
                        </div>
                        <!-- /.card-footer-->
                    </div>
                    <!-- /.card -->

                </section>
            </div>
            <!-- /.tab-pane -->
            <div class="tab-pane" id="Chair">
                <section class="content">

                    <!-- Default box -->
                    <div class="card">
                        <div class="card-body">
                            <table class="table table-hover">
                                <thead>
                                    <tr>
                                        <th>Id</th>
                                        <th>Name</th>
                                        <th width="20%">Image</th>
                                        <th>Price</th>
                                        <th>Quantity</th>
                                        <th width="80%">Detail</th>
                                        <th>Supplier</th>
                                        <th>Category</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    @if (Model != null && Model.Any())
                                    {
                                        foreach (var item in Model)
                                        {
                                            if (@item.Categories.CategoryName == "Chair")
                                            {
                                                <tr id="trow_@item.ProductID">
                                                    <td>@item.ProductID</td>
                                                    <td>@item.Name</td>
                                                    <td><img src="@item.Image" width="100px" alt="IMAGE" /></td>
                                                    <td>@item.Price</td>
                                                    <td>@item.Quantity</td>
                                                    <td>@item.Detail</td>
                                                    <td>@item.Supplier.Name</td>
                                                    <td>@item.Categories.CategoryName</td>
                                                    <td><button class="btn btn-danger remove-product">Remove</button></td>
                                                    <td><a href="/admin/product/edit/@item.ProductID" class="btn btn-primary update-product">Update</a></td>
                                                </tr>
                                            }

                                        }

                                    }
                                    else
                                    {
                                        <tr>
                                            <td colspan="8">No product</td>
                                        </tr>
                                    }
                                </tbody>
                            </table>

                        </div>
                        <!-- /.card-body -->
                        <div class="card-footer">
                        </div>
                        <!-- /.card-footer-->
                    </div>
                    <!-- /.card -->

                </section>
            </div>
            <!-- /.tab-pane -->
            <div class="tab-pane" id="Light">
                <section class="content">

                    <!-- Default box -->
                    <div class="card">
                        <div class="card-body">
                            <table class="table table-hover">
                                <thead>
                                    <tr>
                                        <th>Id</th>
                                        <th>Name</th>
                                        <th width="20%">Image</th>
                                        <th>Price</th>
                                        <th>Quantity</th>
                                        <th width="80%">Detail</th>
                                        <th>Supplier</th>
                                        <th>Category</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    @if (Model != null && Model.Any())
                                    {
                                        foreach (var item in Model)
                                        {
                                            if (@item.Categories.CategoryName == "Light")
                                            {
                                                <tr id="trow_@item.ProductID">
                                                    <td>@item.ProductID</td>
                                                    <td>@item.Name</td>
                                                    <td><img src="@item.Image" width="100px" alt="IMAGE" /></td>
                                                    <td>@item.Price</td>
                                                    <td>@item.Quantity</td>
                                                    <td>@item.Detail</td>
                                                    <td>@item.Supplier.Name</td>
                                                    <td>@item.Categories.CategoryName</td>
                                                    <td><button class="btn btn-danger remove-product">Remove</button></td>
                                                    <td><a href="/admin/product/edit/@item.ProductID" class="btn btn-primary update-product">Update</a></td>
                                                </tr>
                                            }
                                        }

                                    }
                                    else
                                    {
                                        <tr>
                                            <td colspan="8">No product</td>
                                        </tr>
                                    }
                                </tbody>
                            </table>

                        </div>
                        <!-- /.card-body -->
                        <div class="card-footer">
                        </div>
                        <!-- /.card-footer-->
                    </div>
                    <!-- /.card -->

                </section>
            </div>
            <!-- /.tab-pane -->
            <div class="tab-pane" id="Plant">
                <section class="content">

                    <!-- Default box -->
                    <div class="card">
                        <div class="card-body">
                            <table class="table table-hover">
                                <thead>
                                    <tr>
                                        <th>Id</th>
                                        <th>Name</th>
                                        <th width="20%">Image</th>
                                        <th>Price</th>
                                        <th>Quantity</th>
                                        <th width="80%">Detail</th>
                                        <th>Supplier</th>
                                        <th>Category</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    @if (Model != null && Model.Any())
                                    {
                                        foreach (var item in Model)
                                        {
                                            if (@item.Categories.CategoryName == "Plant")
                                            {
                                                <tr id="trow_@item.ProductID">
                                                    <td>@item.ProductID</td>
                                                    <td>@item.Name</td>
                                                    <td><img src="@item.Image" width="100px" alt="IMAGE" /></td>
                                                    <td>@item.Price</td>
                                                    <td>@item.Quantity</td>
                                                    <td>@item.Detail</td>
                                                    <td>@item.Supplier.Name</td>
                                                    <td>@item.Categories.CategoryName</td>
                                                    <td><button class="btn btn-danger remove-product">Remove</button></td>
                                                    <td><a href="/admin/product/edit/@item.ProductID" class="btn btn-primary update-product">Update</a></td>
                                                </tr>
                                            }

                                        }

                                    }
                                    else
                                    {
                                        <tr>
                                            <td colspan="8">No product</td>
                                        </tr>
                                    }
                                </tbody>
                            </table>

                        </div>
                        <!-- /.card-body -->
                        <div class="card-footer">
                        </div>
                        <!-- /.card-footer-->
                    </div>
                    <!-- /.card -->

                </section>
            </div>
        </div>
        <!-- /.tab-content -->
    </div><!-- /.card-body -->
</div>

@section scripts {
    <script>
        $(document).ready(function () {
            $('body').on('click', '.remove-product', function () {
                var tr = $(this).closest('tr');
                var id = tr.attr('id');
                var conf = confirm('Bạn chắc chắn xóa sản phẩm này không');
                if (conf === true) {
                    // Gọi API xóa sản phẩm với id tương ứng
                    $.ajax({
                        url: '/admin/product/remove',
                        type: 'POST',
                        data: { id: id },
                        success: function (rs) {
                            if (rs.success) {
                                tr.remove();
                            } else {
                                alert("Remove fail!!")
                            }
                        }
                    })
                }
            })
        })
        $(document).ready(function () {
            $('body').on('click', '.update-product', function () {
                var tr = $(this).closest('tr');
                var id = tr.attr('id');
                $.ajax({
                    url: `/admin/product/edit/${id}`,
                    type: 'POST',
                    data: { id: id }
                })
            })
        })
    </script>
}
